<task>
Extract ALL Table of Contents entries from these {{len .TocPages}} pages.

Return a complete, ordered list of entries from top to bottom.
</task>

<complete_toc>
{{range .TocPages}}
================================================================================
PAGE {{.PageNum}} of {{$.TotalPages}}
================================================================================
{{.OCRText}}
{{end}}
</complete_toc>
{{if .StructureSummary}}
<global_structure>
The find phase identified this ToC structure:

Total levels: {{.StructureSummary.TotalLevels}}
{{range $level, $pattern := .StructureSummary.LevelPatterns}}
Level {{$level}}:
  - Visual: {{$pattern.Visual}}
  - Numbering: {{if $pattern.Numbering}}{{$pattern.Numbering}}{{else}}None{{end}}
  - Has page numbers: {{$pattern.HasPageNumbers}}
  - Semantic type: {{if $pattern.SemanticType}}{{$pattern.SemanticType}}{{else}}null{{end}}
{{end}}
Use semantic_type from each level as the level_name for entries.
Override only if entry text clearly indicates different type (e.g., "Appendix A").
</global_structure>
{{end}}
<extraction_guidelines>

**TITLE EXTRACTION** (most important!):
- ALWAYS strip prefixes from titles
- "Chapter 5: The War Years" -> title="The War Years", entry_number="5"
- "Prologue: City on Fire" -> title="City on Fire", level_name="prologue"
- "Part III: The End" -> title="The End", entry_number="III"
- Empty titles are valid: "Part I" -> title="", entry_number="I"

**MULTI-LINE TITLES**:
When a title spans multiple lines at the SAME indentation, merge them:
```
Experiments in Happiness:
Life and Love in New Culture China
```
This is ONE entry: title="Experiments in Happiness: Life and Love in New Culture China"

**PARTS WITH TITLES (multi-line entries)**:
If structure_summary shows total_levels=1 and semantic_type="part", then Part + title + page = ONE entry:
```
Part I
The Opening Act
15
```
â†’ entry_number="I", title="The Opening Act", printed_page_number="15"

**HIERARCHY FROM INDENTATION**:
- Level 1: Flush left (no indent)
- Level 2: Moderate indent (typically 2-4 spaces or visual indent)
- Level 3: Deep indent (further indented under Level 2)

**STANDALONE PART MARKERS (2-level structure)**:
If structure_summary shows total_levels=2, Parts are separate from numbered chapters:
- "PART I" + "1 First Chapter" below -> two separate entries
- Part entry: entry_number="I", title="", level=1
- Chapter entry: entry_number="1", title="First Chapter", level=2

**PAGE NUMBERS**:
- Extract from right side: "15", "ix", "xiii", "253"
- null if no page number present

**BACK MATTER**:
Notes, Bibliography, Index, Appendices -> always Level 1

</extraction_guidelines>

<output_format>
Return a JSON array with ALL entries in order:
{
  "entries": [
    {
      "entry_number": "I" or null,
      "title": "text without prefix",
      "level": 1,
      "level_name": "part",
      "printed_page_number": "3" or null
    },
    ...
  ]
}
</output_format>

Extract ALL entries in top-to-bottom order. Be thorough.
