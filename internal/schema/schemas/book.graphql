type Book {
    title: String
    author: String
    authors: [String]
    page_count: Int
    status: String
    created_at: DateTime

    # Metadata from agent
    isbn: String
    lccn: String
    publisher: String
    publication_year: Int
    language: String
    description: String
    subjects: [String]

    # Enrichment (Open Library)
    cover_url: String
    open_library_id: String

    # Processing state
    metadata_started: Boolean
    metadata_complete: Boolean
    metadata_failed: Boolean
    metadata_retries: Int

    # Structure processing state
    structure_started: Boolean
    structure_complete: Boolean
    structure_failed: Boolean
    structure_retries: Int

    # Structure phase tracking (build -> extract -> classify -> polish -> finalize)
    structure_phase: String
    structure_chapters_total: Int
    structure_chapters_extracted: Int
    structure_chapters_polished: Int
    structure_polish_failed: Int

    # Structure stats
    total_chapters: Int
    total_paragraphs: Int
    total_words: Int

    # Page pattern analysis state (early pipeline - after blend, before label)
    pattern_analysis_started: Boolean
    pattern_analysis_complete: Boolean
    pattern_analysis_failed: Boolean
    pattern_analysis_retries: Int

    # Page pattern analysis result (JSON)
    # Contains: page_number_pattern, body_boundaries, chapter_patterns, reasoning
    # Detects page numbering patterns, body boundaries, and chapter clusters
    page_pattern_analysis_json: String

    # Pattern analysis from finalize_toc (JSON)
    # Contains: discovered_patterns, excluded_ranges, entries_to_find, reasoning
    pattern_analysis_json: String

    # Finalize progress tracking (for restart resilience)
    finalize_entries_complete: Int
    finalize_entries_found: Int
    finalize_gaps_complete: Int
    finalize_gaps_fixes: Int

    # Relationships
    # One-to-many: Book has many Pages
    pages: [Page]
    # One-to-one: Book has one ToC (@primary on this side)
    toc: ToC @primary
    # One-to-many: Book has many Chapters
    chapters: [Chapter]
    # One-to-many: Book has many AgentStates (for job resume)
    agent_states: [AgentState]
}
